MAP_ProductCategory:
MAPPING LOAD
    [ProductCategoryID],
    [Name]
FROM [lib://DataFiles/Data-Landing-Zone/SalesLT/ProductCategory.qvd] (QVD);


DIM_Product:
LOAD
	[ProductID]																AS [%Product_KEY],
	[ProductNumber]															AS [Product Number],
	[Color]																	AS [Product Color],
	[ProductCategoryID],
	[ProductModelID]
FROM [lib://DataFiles/Data-Landing-Zone/SalesLT/Product.qvd] (QVD);

LEFT JOIN (DIM_Product)
LOAD
	[ProductCategoryID],
	APPLYMAP('MAP_ProductCategory', [ParentProductCategoryID], 'Geen') 		AS [Product Category],
    [Name]																	AS [Product Subcategory]
FROM [lib://DataFiles/Data-Landing-Zone/SalesLT/ProductCategory.qvd] (QVD);

LEFT JOIN (DIM_Product)
LOAD
    ProductModelID,
    [Name]																	AS [Product Model]
FROM [lib://DataFiles/Data-Landing-Zone/SalesLT/ProductModel.qvd] (QVD);


STORE [DIM_Product] INTO [lib://DataFiles/Data-Product/SalesLT/DIM_Product.qvd] (QVD);
DROP TABLE [DIM_Product];
